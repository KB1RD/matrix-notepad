(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1325:function(e,t,r){"use strict";r.r(t);r(312),r(119),r(82),r(65),r(149),r(81);var n=r(25),o=(r(147),r(315),r(204)),l=r(308),c=r(1311),m=r(51);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(source,!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(source).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={layout:"gradient-bg-full",components:{SimpleSVG:c.SimpleSVG},data:function(){return{settings:this.$form.createForm(this),infer_hs:!0,signing_in:!0}},computed:{is_busy:function(){return this.$store.getters.hasBlockingOperation}},mounted:function(){var e=this;this.$onPersistStoreReady((function(){if(e.$store.state.matrix.matrix_state&&""!==e.$store.state.matrix.matrix_state&&"STOPPED"!==e.$store.state.matrix.matrix_state)e.redirect();else{var t=e.$store.state.matrix.credentials;t.hs&&t.access_token&&e.performSignInOperation(e.$matrix.tokenSignIn(t.hs,t.access_token))}}))},methods:f({redirect:function(){var path=this.$route.query.redirect_to||"/";path.startsWith("/")||(path="/"+path),this.$router.replace({path:path})},onUserIdChange:function(e){e.target.value.length&&(e.target.value.lastIndexOf("@")>0&&(e.target.value=e.target.value.replace(/@/g,"")),e.target.value.startsWith("@")||(e.target.value="@"+e.target.value))},performSignInOperation:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$matrix.shutdown();var r=this.$message.loading("Signing in...",0),o=this;o.$store.dispatch("watchBlockingOperation",Object(n.a)(regeneratorRuntime.mark((function n(){var data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e;case 3:data=n.sent,t&&o.updateSettings(f({},data,{room:""})),o.$message.success("You're signed in!"),o.setup_visible=!1,o.redirect(),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),m.a.error("Failed to sign in",n.t0),o.$message.error("Failed to sign in!");case 14:r();case 15:case"end":return n.stop()}}),n,null,[[0,10]])})))())},onFormSubmit:function(e){e.preventDefault();var t=this;this.settings.validateFields((function(e,r){e||t.performSignInOperation(t.$matrix.userPassSignIn(r.url,r.id,r.pass),!0)}))}},Object(l.b)({updateSettings:"matrix/updateSettings"}))},h=r(68),component=Object(h.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("SimpleSVG",{attrs:{id:"logo-svg",filepath:"/logo/notepad logo.svg",fill:"#fff",stroke:"#fff"}}),e._v(" "),r("a-card",{attrs:{id:"signin-dialog"}},[r("a-card-meta",{attrs:{title:"Sign In"},scopedSlots:e._u([{key:"description",fn:function(){return[e._v("\n        Software written by Matrix users like you. Check it out on\n        "),r("a",{attrs:{href:"https://github.com/KB1RD/matrix-notepad"}},[e._v("GitHub")]),e._v(" and come\n        chat on\n        "),r("a",{attrs:{href:"https://matrix.to/#/#matrix-collaboration:kb1rd.net?via=kb1rd.net&via=matrix.org&via=matrix.geklautecloud.de"}},[e._v("\n          #matrix-collaboration:kb1rd.net.\n        ")])]},proxy:!0}])}),e._v(" "),r("a-form",{staticStyle:{"margin-top":"50px","text-align":"left"},attrs:{form:e.settings,layout:"vertical","hide-required-mark":""},on:{submit:e.onFormSubmit}},[r("a-row",{attrs:{gutter:16}},[r("a-col",[r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[{required:!0,message:"Enter your username"},{pattern:/^[@][^\@\:]*:[^\@\:]*(:[0-9]+)?$/gm,message:"Enter your full Matrix ID (ex. @name:server.org)"}]}],expression:"[\n                'id',\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message: 'Enter your username'\n                    },\n                    {\n                      pattern: /^[@][^\\@\\:]*:[^\\@\\:]*(:[0-9]+)?$/gm,\n                      message:\n                        'Enter your full Matrix ID (ex. @name:server.org)'\n                    }\n                  ]\n                }\n              ]"}],attrs:{placeholder:"@name:server.org",disabled:e.is_busy},on:{change:e.onUserIdChange}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1)],1)],1),e._v(" "),r("a-row",{attrs:{gutter:16}},[r("a-col",[r("a-form-item",[r("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["pass",{rules:[{required:!0,message:"Enter your password"}]}],expression:"[\n                'pass',\n                {\n                  rules: [\n                    {\n                      required: true,\n                      message: 'Enter your password'\n                    }\n                  ]\n                }\n              ]"}],attrs:{placeholder:"Password",disabled:e.is_busy}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1)],1),e._v(" "),r("a-row",{attrs:{gutter:16}},[r("a-col",[r("a-form-item",[r("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["infer_hs"],expression:"['infer_hs']"}],attrs:{disabled:e.is_busy},model:{value:e.infer_hs,callback:function(t){e.infer_hs=t},expression:"infer_hs"}},[e._v("\n              Infer homeserver URL\n            ")])],1)],1)],1),e._v(" "),e.infer_hs?e._e():r("a-row",{attrs:{gutter:16}},[r("a-col",[r("a-form-item",{attrs:{label:"Homeserver URL"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["url",{rules:[{required:!e.infer_hs,message:"Enter the your homeserver URL"}]}],expression:"[\n                'url',\n                {\n                  rules: [\n                    {\n                      required: !infer_hs,\n                      message: 'Enter the your homeserver URL'\n                    }\n                  ]\n                }\n              ]"}],attrs:{placeholder:"https://server.org",disabled:e.is_busy}},[r("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"database"},slot:"prefix"})],1)],1)],1)],1),e._v(" "),r("a-row",{attrs:{gutter:16}},[r("a-col",[r("a-button",{attrs:{"html-type":"submit",type:"primary",block:"",loading:e.is_busy}},[e._v("\n            "+e._s(e.is_busy?"Working...":"Sign In")+"\n          ")])],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);